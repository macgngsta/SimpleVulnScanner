package com.gregtam.scanner;

import java.util.List;

import org.apache.log4j.Logger;

import com.gregtam.scanner.util.FileObject;
import com.gregtam.scanner.util.FileUtil;
import com.gregtam.scanner.util.ValidationUtil;

public class SimpleVulnerabilityScanner
{

	static Logger logger = Logger.getLogger(SimpleVulnerabilityScanner.class
			.getName());

	/**
	 * @param args
	 */
	public static void main(String[] args)
	{
		if (args != null && args.length > 0)
		{
			String folderPath = args[0];

			if (ValidationUtil.isNotNullAndEmpty(folderPath))
			{
				// read in the folder from arg0
				logger.debug("reading from: " + folderPath);

				List<FileObject> myList = FileUtil.getAllFiles(folderPath);

				logger.debug("found " + myList.size() + " files to process");

				// from the file list, read into the php code and extract
				// relationships
				logger.debug("extracting relationships");

				// use vuln modules to test db
				logger.debug("searching for vulns");

				// print out report
				logger.debug("printing report");
			}
			else
			{
				logger.error("folder path was null or empty.");
			}
		}
		else
		{
			logger.error("no args passed");
		}
	}
}
